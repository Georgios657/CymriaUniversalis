# This file contains all effects which are are needed for dynamic effects, but have more than 512 characters in total.
# It also has the dynamic effect itself too.
#Use insight_tooltip = INSIGHT_JUST_TOOLTIP if you don't want to have anything specific
country_event_with_insight = {
	country_event = {
		id = $id$
		[[days] days = $days$]
		[[random] random = $random$]
		[[tooltip] tooltip = $tooltip$]
	}
	custom_tooltip = EVENT_INSIGHT_INTRO
	custom_tooltip = $insight_tooltip$
	[[effect_tooltip] tooltip = { $effect_tooltip$ }]
}

# "Simple" as in "Do not put too many characters in the input argument or else it will not work"
# This serves as both an useful effect for small dynamic mission rewards
# And as a reminder how the template for the dynamic mission rewards should look like

# Use this if you want the rewards / triggers to be exclusive
# This means if a AND b are fulfilled then the player gets only reward from a
# IMPORTANT: They do NOT fire events for some reason.
simple_dynamic_effect = {
	custom_tooltip = $first_custom_tooltip$
	if = {
		limit = {
			$first_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$first_effect$
	}
	custom_tooltip = mission_alternatively_tt
	[[second_custom_tooltip] custom_tooltip = $second_custom_tooltip$ ]
	if = {
		limit = {
			$second_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$second_effect$
	}
	hidden_effect = {
		if = {
			limit = { $first_limit$ }
			$first_effect$
		}
		else = {
			$second_effect$
		}
	}
}

# Use this if you want the rewards / triggers to be additive
# This means if a AND b are fulfilled then the player gets both
simple_dynamic_effect_without_alternative = {
	custom_tooltip = $first_custom_tooltip$
	if = {
		limit = {
			$first_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$first_effect$
	}
	[[second_custom_tooltip] custom_tooltip = $second_custom_tooltip$ ]
	if = {
		limit = {
			$second_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$second_effect$
	}
	hidden_effect = {
		if = {
			limit = { $first_limit$ }
			$first_effect$
		}
		if = {
			limit = { $second_limit$ }
			$second_effect$
		}
	}
}

# "Complex" as in "if you need this effect then you should rethink your mission reward"
# Supports up to 10 dynamic effects
# Will probably result in a grocery list when you hover over the effects though
complex_dynamic_effect = {
	custom_tooltip = $first_custom_tooltip$
	if = {
		limit = {
			$first_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$first_effect$
	}

	[[second_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $second_custom_tooltip$
	if = {
		limit = {
			$second_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$second_effect$
	}
	]

	[[third_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $third_custom_tooltip$
	if = {
		limit = {
			$third_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$third_effect$
	}
	]

	[[fourth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $fourth_custom_tooltip$
	if = {
		limit = {
			$fourth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$fourth_effect$
	}
	]

	[[fifth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $fifth_custom_tooltip$
	if = {
		limit = {
			$fifth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$fifth_effect$
	}
	]

	[[sixth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $sixth_custom_tooltip$
	if = {
		limit = {
			$sixth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$sixth_effect$
	}
	]

	[[seventh_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $seventh_custom_tooltip$
	if = {
		limit = {
			$seventh_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$seventh_effect$
	}
	]

	[[eighth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $eighth_custom_tooltip$
	if = {
		limit = {
			$eighth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$eighth_effect$
	}
	]

	[[nineth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $nineth_custom_tooltip$
	if = {
		limit = {
			$nineth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$nineth_effect$
	}
	]

	[[tenth_custom_tooltip] 
	custom_tooltip = mission_alternatively_tt
	custom_tooltip = $tenth_custom_tooltip$
	if = {
		limit = {
			$tenth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$tenth_effect$
	}
	]

	hidden_effect = {
		if = {
			limit = { $first_limit$ }
			$first_effect$
		}
		[[second_custom_tooltip] 
		else_if = {
			limit = { $second_limit$ }
			$second_effect$
		}
		]
		[[third_custom_tooltip] 
		else_if = {
			limit = { $third_limit$ }
			$third_effect$
		}
		]
		[[fourth_custom_tooltip] 
		else_if = {
			limit = { $fourth_limit$ }
			$fourth_effect$
		}
		]
		[[fifth_custom_tooltip] 
		else_if = {
			limit = { $fifth_limit$ }
			$fifth_effect$
		}
		]
		[[sixth_custom_tooltip] 
		else_if = {
			limit = { $sixth_limit$ }
			$sixth_effect$
		}
		]
		[[seventh_custom_tooltip] 
		else_if = {
			limit = { $seventh_limit$ }
			$seventh_effect$
		}
		]
		[[eigth_custom_tooltip] 
		else_if = {
			limit = { $eigth_limit$ }
			$eigth_effect$
		}
		]
		[[nineth_custom_tooltip] 
		else_if = {
			limit = { $nineth_limit$ }
			$nineth_effect$
		}
		]
		[[tenth_custom_tooltip] 
		else_if = {
			limit = { $tenth_limit$ }
			$tenth_effect$
		}
		]
	}
}

# Use this if you want the rewards / triggers to be additive
# This means if a AND b are fulfilled then the player gets both
complex_dynamic_effect_without_alternative = {
	custom_tooltip = $first_custom_tooltip$
	if = {
		limit = {
			$first_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$first_effect$
	}

	[[second_custom_tooltip] 
	custom_tooltip = $second_custom_tooltip$
	if = {
		limit = {
			$second_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$second_effect$
	}
	]

	[[third_custom_tooltip] 
	custom_tooltip = $third_custom_tooltip$
	if = {
		limit = {
			$third_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$third_effect$
	}
	]

	[[fourth_custom_tooltip] 
	custom_tooltip = $fourth_custom_tooltip$
	if = {
		limit = {
			$fourth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$fourth_effect$
	}
	]

	[[fifth_custom_tooltip] 
	custom_tooltip = $fifth_custom_tooltip$
	if = {
		limit = {
			$fifth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$fifth_effect$
	}
	]

	[[sixth_custom_tooltip] 
	custom_tooltip = $sixth_custom_tooltip$
	if = {
		limit = {
			$sixth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$sixth_effect$
	}
	]

	[[seventh_custom_tooltip] 
	custom_tooltip = $seventh_custom_tooltip$
	if = {
		limit = {
			$seventh_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$seventh_effect$
	}
	]

	[[eighth_custom_tooltip] 
	custom_tooltip = $eighth_custom_tooltip$
	if = {
		limit = {
			$eighth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$eighth_effect$
	}
	]

	[[nineth_custom_tooltip] 
	custom_tooltip = $nineth_custom_tooltip$
	if = {
		limit = {
			$nineth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$nineth_effect$
	}
	]

	[[tenth_custom_tooltip] 
	custom_tooltip = $tenth_custom_tooltip$
	if = {
		limit = {
			$tenth_limit$
		}
		custom_tooltip = BONUS_REWARD_YES
	}
	else = { custom_tooltip = BONUS_REWARD_NO }
	tooltip = {
		$tenth_effect$
	}
	]

	[[combined_effect]
	if = {
		limit = {
			$first_limit$
			$second_limit$
			$third_limit$
			$fourth_limit$
			$fifth_limit$
			$sixth_limit$
			$seventh_limit$
			$eigth_limit$
			$nineth_limit$
			$tenth_limit$
		}
		custom_tooltip = COMBINED_BONUS_REWARD_YES
	}
	else = { custom_tooltip = COMBINED_BONUS_REWARD_NO }
	tooltip = {
		$combined_effect$
	}
	]

	hidden_effect = {
		if = {
			limit = { $first_limit$ }
			$first_effect$
		}
		[[second_custom_tooltip] 
		if = {
			limit = { $second_limit$ }
			$second_effect$
		}
		]
		[[third_custom_tooltip] 
		if = {
			limit = { $third_limit$ }
			$third_effect$
		}
		]
		[[fourth_custom_tooltip] 
		if = {
			limit = { $fourth_limit$ }
			$fourth_effect$
		}
		]
		[[fifth_custom_tooltip] 
		if = {
			limit = { $fifth_limit$ }
			$fifth_effect$
		}
		]
		[[sixth_custom_tooltip] 
		if = {
			limit = { $sixth_limit$ }
			$sixth_effect$
		}
		]
		[[seventh_custom_tooltip] 
		if = {
			limit = { $seventh_limit$ }
			$seventh_effect$
		}
		]
		[[eigth_custom_tooltip] 
		if = {
			limit = { $eigth_limit$ }
			$eigth_effect$
		}
		]
		[[nineth_custom_tooltip] 
		if = {
			limit = { $nineth_limit$ }
			$nineth_effect$
		}
		]
		[[tenth_custom_tooltip] 
		if = {
			limit = { $tenth_limit$ }
			$tenth_effect$
		}
		]
		[[combined_effect] 
		if = {
			limit = {
				$first_limit$
				$second_limit$
				$third_limit$
				$fourth_limit$
				$fifth_limit$
				$sixth_limit$
				$seventh_limit$
				$eigth_limit$
				$nineth_limit$
				$tenth_limit$
			}
			$combined_effect$
		}
		]
	}
}

#Tag specific reward for the dynamic effects
#Ottoman Mission Rewards
tur_crimean_khaganate_effect_a = {
	CRI = {
		add_historical_friend = ROOT
		if = {
			limit = {
				is_subject_of_type = tributary_state
			}
			tooltip = {
				ROOT = {
					create_subject = {
						subject_type = march
						who = PREV
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { is_subject_of_type = tributary_state }
				grant_independence = yes
				ROOT = {
					create_subject = {
						subject_type = march
						who = PREV
					}
				}
			}
		}
	}
	add_historical_friend = CRI 
	add_country_modifier = { 
		name = tur_tatar_vanguard_modifier
		duration = -1 
		desc = as_long_as_they_are_subject_desc
	}
}

tur_address_firman_effect_a = {
	hidden_effect = {
		if = {
			limit = {
				GRA = {
					OR = {
						is_subject_of = ROOT
						alliance_with = ROOT
					}
				}
			}
			GRA = { save_event_target_as = tur_andalusian_ally }
		}
		else_if = {
			limit = {
				ADU = {
					OR = {
						is_subject_of = ROOT
						alliance_with = ROOT
					}
				}
			}
			ADU = { save_event_target_as = tur_andalusian_ally }
		}
		if = {
			limit = { has_saved_event_target = tur_andalusian_ally }
			add_historical_friend = event_target:tur_andalusian_ally 
			event_target:tur_andalusian_ally = { 
				add_historical_friend = ROOT
				add_country_modifier = {
					name = tur_turkish_andalusian_relations_gra
					duration = -1
					hidden = yes
				}
				add_accepted_culture = turkish
				random_province = { 
					limit = { owned_by = event_target:tur_andalusian_ally is_capital = no has_port = yes culture = event_target:tur_andalusian } 
					add_base_tax = 2
					add_base_production = 2
					add_base_manpower = 2
					change_religion = ROOT
					change_culture = turkish
				}
				for = {
					amount = 3
					effect = "random_owned_province = { add_base_tax = 1 }"
				}
				for = {
					amount = 3
					effect = "random_owned_province = { add_base_production = 1 }"
				}
				for = {
					amount = 3
					effect = "random_owned_province = { add_base_manpower = 1 }"
				}
			}
			add_country_modifier = {
				name = tur_turkish_andalusian_relations_tur
				duration = -1
				hidden = yes
			}
			add_accepted_culture = andalucian
			random_province = { 
				limit = { owned_by = ROOT is_capital = no culture = event_target:tur_andalusian_ally has_port = yes }
				add_base_tax = 2
				add_base_production = 2
				add_base_manpower = 2
				change_religion = event_target:tur_andalusian_ally
				change_culture = andalucian
			}
			#for = {
			#	amount = 4
			#	effect = "random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }"
			#}
			random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }
			random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }
			random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }
			random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }
			random_owned_province = { random_list = { 1 = { add_base_tax = 2 } 1 = { add_base_production = 2 } 1 = { add_base_manpower = 2 } } }
		}
	}
}

tur_address_firman_effect_b = {

}

tur_al_andalus_eyalet_effect_a = {
	add_country_modifier = {
		name = tur_re_reconquista
		duration = -1
	}
	custom_tooltip = tur_al_andalus_eyalet_bt
	hidden_effect = {
		if = {
			limit = {
				any_subject_country = {
					religion = ROOT
					owns = 225
					owns = 223
					owns = 226
					owns = 224
					num_of_owned_provinces_with = {
						region = iberia_region
						value = 10
					}
					capital_scope = {
						region = iberia_region
					}
				}
			}
			random_subject_country = {
				limit = {
					religion = ROOT
					owns = 225
					owns = 223
					owns = 226
					owns = 224
					num_of_owned_provinces_with = {
						region = iberia_region
						value = 10
					}
					capital_scope = {
						region = iberia_region
					}
				}
				add_country_modifier = {
					name = tur_re_reconquista
					duration = -1
				}
			}
		}
		if = {
			limit = {
				any_ally = {
					religion = ROOT
					owns = 225
					owns = 223
					owns = 226
					owns = 224
					num_of_owned_provinces_with = {
						region = iberia_region
						value = 10
					}
					capital_scope = {
						region = iberia_region
					}
				}
			}
			random_ally = {
				limit = {
					religion = ROOT
					owns = 225
					owns = 223
					owns = 226
					owns = 224
					num_of_owned_provinces_with = {
						region = iberia_region
						value = 10
					}
					capital_scope = {
						region = iberia_region
					}
				}
				add_country_modifier = {
					name = tur_re_reconquista
					duration = -1
				}
			}
		}
	}
}

#British Mission Rewards
gbr_take_over_the_lowlands_effect_a = {
	add_country_modifier = {
		name = gbr_english_dutch_trade_partners
		duration = -1
		desc = UNTIL_ALLIANCE_BREAK
	}
	hidden_effect = {
		random_ally = {
			limit = {
				capital_scope = {
					region = low_countries_region
				}
				OR = {
					primary_culture = dutch
					primary_culture = flemish
					primary_culture = frisian
					primary_culture = wallonian
				}
				num_of_owned_provinces_with = {
					region = low_countries_region
					value = 15
				}
			}
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = ROOT }
			add_country_modifier = {
				name = gbr_english_dutch_trade_partners
				duration = -1
			}
		}
	}
}

#Persian missions
per_claim_constantinople_effect = {
	151 = {
		if = {
			limit = { root = { has_country_flag = per_zoroastrian_missions } }
			change_province_name = "Kustantiniya"
			rename_capital = "Kustantiniya"
		}
		else = {
			change_province_name = "Konstantiniyyeh"
			rename_capital = "Konstantiniyyeh"
		}
		add_base_tax = 2
		add_base_production = 2
		add_base_manpower = 1
		add_province_modifier = {
			name = per_the_second_capital
			duration = -1
		}
	}
}
per_invade_india_effect = {
	add_adm_power = 75
	add_permanent_claim_multi_provinces = { target = northern_sindh_area }
	add_permanent_claim_multi_provinces = { target = sindh_area }
	add_permanent_claim_multi_provinces = { target = jangladesh_area }
	add_permanent_claim_multi_provinces = { target = marwar_area }
	add_permanent_claim_multi_provinces = { target = patan_area }
	add_permanent_claim_multi_provinces = { target = saurashtra_area }
	add_permanent_claim_multi_provinces = { target = jaipur_area }
}


BYZ_convert_to_greek_culture = { #It's here in case I want to add anatolian-themed cultures.
	if = {
		limit = {
			OR = {
				area = erzurum_area
				area = kastamonu_area
			}
		}
		change_culture = pontic_greek
	}
	else = {
		change_culture = greek
	}
}

BYZ_upgrade_hexamilion_if_possible = {
	clr_country_flag = BYZ_upgrading_hexamilion
	
	4701 = {
		if = {
			limit = {
				owned_by = ROOT
			}
			if = {
				limit = {
					has_province_modifier = BYZ_hexamilion_wall_2
				}
				#nothing should happen. should not be achievable
			}
			else_if = {
				limit = {
					has_province_modifier = BYZ_hexamilion_wall_1
				}
				remove_province_modifier = BYZ_hexamilion_wall_1
				add_province_modifier = {
					name = BYZ_hexamilion_wall_2
					duration = -1
				}
			}
			else = {
				add_province_modifier = {
					name = BYZ_hexamilion_wall_1
					duration = -1
				}
			}
		}
	}
}

BYZ_upgrade_theodosian_if_possible = {
	clr_country_flag = BYZ_upgrading_theodosian
	
	151 = {
		if = {
			limit = {
				owned_by = ROOT
			}
			if = {
				limit = {
					has_province_modifier = BYZ_theodosian_wall_3
				}
				#nothing should happen. should not be achievable
			}
			else_if = {
				limit = {
					has_province_modifier = BYZ_theodosian_wall_2
				}
				remove_province_modifier = BYZ_theodosian_wall_2
				add_province_modifier = {
					name = BYZ_theodosian_wall_3
					duration = -1
				}
			}
			else_if = {
				limit = {
					has_province_modifier = BYZ_theodosian_wall_1
				}
				remove_province_modifier = BYZ_theodosian_wall_1
				add_province_modifier = {
					name = BYZ_theodosian_wall_2
					duration = -1
				}
			}
			else = {
				add_province_modifier = {
					name = BYZ_theodosian_wall_1
					duration = -1
				}
			}
		}
	}
}

BYZ_branch_effect = {
	custom_tooltip = BYZ_this_is_a_branching_mission
}

BYZ_if_saved_export_variable = {
	if = {
		limit = {
			has_saved_event_target = $name$
		}
		event_target:$name$ = {
			export_to_variable = {
				variable_name = byz_yearly_income
				value = years_of_income
			}
		}
	}
}

BYZ_offer_mosaicists = {
	custom_tooltip = BYZ_we_will_offer_to_this_for
	
	tooltip = {
		if = {
			limit = {
				has_dlc = "Leviathan"
			}
			add_country_modifier = {
				name = BYZ_mosaicists_Leviathan
				duration = 3650
			}
		}
		else = {
			add_country_modifier = {
				name = BYZ_mosaicists
				duration = 3650
			}
		}
	}
	
	custom_tooltip = BYZ_if_they_deny_we_will_still_get_modifier
	
	hidden_effect = {
		country_event = { id = MEE_Byzantine_Events.25 }
	}
}

ARB_flavor_event_6_effect = {
		
	add_permanent_power_projection = {
		type = arb_permanent_power_projection
		amount = 10
	}

	custom_tooltip = " "
	
	if = {
		limit = {
			has_dlc = "Mandate of Heaven"
		}
		custom_tooltip = ARB_golden_age_renewal_tt
		hidden_effect = {
			if = {
				limit = { has_had_golden_age = yes } 
				reset_golden_age = yes 
			}
			else_if = {
				limit = { in_golden_age = yes } 
				extend_golden_age = 600
			}
		}
		custom_tooltip = " "
	}
	else = {
		add_country_modifier = {
			name = ARB_second_islamic_golden_age_modifier
			duration = 18250
		}
	}
	
	custom_tooltip = ARB_permanent_claims_on_all_muslim_provinces
	
	custom_tooltip = " "
	
	if = {
		limit = {
			has_country_modifier = unified_islam
		}
		add_country_modifier = {
			name = ARB_united_islam_upgraded
			duration = -1
		}
	}
	else = {
		set_country_flag = ARB_upgraded_uniting_islam
		custom_tooltip = ARB_uniting_islam_will_now_give_10_warscore_cost_vs_other_religions
	}
}

add_persian_and_zoroastrian_influence = {
	if = {
		limit = { has_government_mechanic = persian_influence_mechanic }
		add_government_power = {
			mechanic_type = persian_influence_mechanic
			power_type = persian_influence
			value = $value$
		}
	}
	if = {
		limit = { has_government_mechanic = the_three_royal_fires_mechanic }
		add_government_power = {
			mechanic_type = the_three_royal_fires_mechanic
			power_type = asha_vahishta
			value = $value$
		}
	}
}

pick_best_provinces = {
	[[scope]
		pick_best_provinces_2 = {
			scope = "$scope$"
			scale = "$scale$"
			event_target_name = "$event_target_name$"
			global_trigger = "$global_trigger$"
			1 = "$1$"
			2 = "$2$"
			3 = "$3$"
			4 = "$4$"
			5 = "$5$"
			10 = "$10$"
		}
		set_global_flag = PICK_BEST_PROVINCES_FLAG
	] #curses for not having an [ELSE ] or something.
	if = {
		limit = {
			NOT = { has_global_flag = PICK_BEST_PROVINCES_FLAG } #This check is here to prevent the algorithm from being run again after the scoped version was executed
		}
		pick_best_provinces_2 = {
			scope = " every_province "
			scale = "$scale$"
			event_target_name = "$event_target_name$"
			global_trigger = "$global_trigger$"
			1 = "$1$"
			2 = "$2$"
			3 = "$3$"
			4 = "$4$"
			5 = "$5$"
			10 = "$10$"
		}
	}
	else = { clr_global_flag = PICK_BEST_PROVINCES_FLAG }
}

pick_best_provinces_2 = {
	hidden_effect = {
		[[1]
			if = {
				limit = { always = $1$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
			}
		]
		[[2]
			if = {
				limit = { always = $2$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
			}
		]
		[[3]
			if = {
				limit = { always = $3$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
			}
		]
		[[4]
			if = {
				limit = { always = $4$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
			}
		]
		[[5]
			if = {
				limit = { always = $5$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 5
				}
			}
		]
		[[10]
			if = {
				limit = { always = $10$ }
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 5
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 6
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 7
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 8
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 9
				}
				pick_best_province = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 10
				}
			}
		]
		$scope$ = {
			limit = {
				has_province_flag = $event_target_name$_exclude
			}
			clr_province_flag = $event_target_name$_exclude
		}
	}
}

pick_best_province = {
	$scope$ = {
		limit = {
			[[global_trigger] $global_trigger$ ]
			NOT = { has_province_flag = $event_target_name$_exclude }
		}
		save_event_target_as = $event_target_name$_$number$
	}
	$scope$ = {
		limit = {
			[[global_trigger] $global_trigger$ ]
			$scale$ = event_target:$event_target_name$_$number$
			NOT = { has_province_flag = $event_target_name$_exclude }
		}
		save_event_target_as = $event_target_name$_$number$
	}
	event_target:$event_target_name$_$number$ = {
		set_province_flag = $event_target_name$_exclude
	}
}

create_general_with_pips = {
	create_general = {
		tradition = $tradition$
		[[add_fire] add_fire = $add_fire$ ]
		[[add_shock] add_shock = $add_shock$ ]
		[[add_manuever] add_manuever = $add_manuever$ ]
		[[add_siege] add_siege = $add_siege$ ]
		[[name] name = "$name$" ]
		[[culture] culture = $culture$ ]
	}
	custom_tooltip = ME_GENERAL_$add_fire$_$add_shock$_$add_manuever$_$add_siege$
}

mission_give_province_claims = {
	$id$ = {
		if = {
			limit = {
				NOT = { is_core = $tag$ }
				NOT = { is_permanent_claim = $tag$ }
			}
			add_permanent_claim = $tag$
		}
	}
}

mission_give_area_claims = {
	$group$ = {
		limit = {
			NOT = { is_core = $tag$ }
			NOT = { is_permanent_claim = $tag$ }
		}
		add_permanent_claim = $tag$
	}
}

give_claims = {
	[[province]
		mission_give_province_claims = { id = $province$ tag = ROOT }
	]
	[[id]
		mission_give_province_claims = { id = $id$ tag = ROOT }
	]
	[[area]
		mission_give_area_claims = { group = $area$ tag = ROOT }
	]
	[[region]
		mission_give_area_claims = { group = $region$ tag = ROOT }
	]

}

add_power_projection_mission = {
	add_power_projection = {
		type = mission_rewards_power_projection
		amount = $amount$
	}
}

country_event_with_effect_insight = {
	country_event = {
		id = $id$
		[[days] days = $days$]
		[[random] random = $random$]
		[[tooltip] tooltip = $tooltip$]
	}
	custom_tooltip = EVENT_INSIGHT_INTRO
	tooltip = {
		$effect$
	}
}

country_event_with_option_insight = {
	country_event = {
		id = $id$
		[[days] days = $days$]
		[[random] random = $random$]
		[[tooltip] tooltip = $tooltip$]
	}
	custom_tooltip = EVENT_INSIGHT_INTRO
	custom_tooltip = EVENT_INSIGHT_OPT_1
	tooltip = {
		$option_1$
	}
	[[option_2]
		custom_tooltip = EVENT_INSIGHT_OPT_2
		tooltip = {
			$option_2$
		}
	]
	[[option_3]
		custom_tooltip = EVENT_INSIGHT_OPT_3
		tooltip = {
			$option_3$
		}
	]
	[[option_4]
		custom_tooltip = EVENT_INSIGHT_OPT_4
		tooltip = {
			$option_4$
		}
	]
	[[option_5]
		custom_tooltip = EVENT_INSIGHT_OPT_5
		tooltip = {
			$option_5$
		}
	]
}

######################################
# Branching Missions Preview Effects #
######################################
enable_branching_mission_review_of_batch = {
	if = {
		limit = { not = { has_country_flag = has_batch_1_active } }
		set_country_flag = has_batch_1_active
		set_country_flag = can_choose_$key$_1_branching_missions
	}
	else_if = {
		limit = { not = { has_country_flag = has_batch_2_active } }
		set_country_flag = has_batch_2_active
		set_country_flag = can_choose_$key$_2_branching_missions
	}
	else_if = {
		limit = { not = { has_country_flag = has_batch_3_active } }
		set_country_flag = has_batch_3_active
		set_country_flag = can_choose_$key$_3_branching_missions
	}
	else = {
		log = "Too many mission batches active at the same time. Make sure that any given moment only 3 batches are active to preview"
	}
}
enable_branching_mission_review = {
	if = {
		limit = { ai = yes }
		country_event = { id = $ai_event_id$ }
	}
	else = {
		custom_tooltip = BYZ_unlock_branches_decision
		hidden_effect = {
			enable_branching_mission_review_of_batch = { key = $key$ }
			change_variable = {
				which = can_preview_missions_var
				value = 1
			}
		}
	}
}
enable_branching_mission_review_without_ai = {
	custom_tooltip = BYZ_unlock_branches_decision
	hidden_effect = {
		enable_branching_mission_review_of_batch = { key = $key$ }
		change_variable = {
			which = can_preview_missions_var
			value = 1
		}
	}
}

select_current_missions_MAL = {}	#Empty on purpose, preview system only implemented for the sake of completion
select_current_missions_SON = {
	if = {
		limit = { has_country_flag = son_islamic_focus }
		hidden_effect = { clr_country_flag = son_tolerance_focus }
		add_estate_loyalty = {
			estate = estate_church
			loyalty = 10
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -10
		}
		add_estate_loyalty = {
			estate = estate_dhimmi
			loyalty = -10
		}
	}
	if = {
		limit = { has_country_flag = son_tolerance_focus }
		hidden_effect = { clr_country_flag = son_islamic_focus }
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -10
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 10
		}
		add_estate_loyalty = {
			estate = estate_dhimmi
			loyalty = 10
		}
	}
}
select_current_missions_KON = {}	#Empty on purpose, preview system only implemented for the sake of completion
select_scandinavian_religion_mission_effect = {
	if = {
		limit = { has_country_flag = sca_unlock_catholic_missions }
		if = {
			limit = { NOT = { religion = catholic } }
			add_stability = -2
			custom_tooltip = flavor_sca.1.a.tt
			if = {
				limit = {
					NOT = { religion = coptic }
					NOT = { religion = orthodox }
				}
				hidden_effect = {
					every_known_country = {
						limit = {
							religion = ROOT
						}
						add_opinion = {
							who = ROOT
							modifier = swe_abandoned_the_reformation
						}
					}
				}
			}
			else = {
				hidden_effect = {
					every_known_country = {
						limit = {
							religion = ROOT
						}
						add_opinion = {
							who = ROOT
							modifier = swe_betrayed_our_faith
						}
					}
				}
			}
			change_religion = catholic
			capital_scope = {
				change_religion = catholic
			}
			random_owned_province = {
				limit = {
					region = scandinavia_region
					NOT = { religion = catholic }
				}
				change_religion = catholic
			}
		}
	}
	if = {
		limit = { has_country_flag = sca_unlock_protestant_missions }
		if = {
			limit = { religion = catholic }
			add_stability = -2
			custom_tooltip = flavor_sca.1.a.tt
			hidden_effect = {
				every_known_country = {
					limit = {
						religion = ROOT
					}
					add_opinion = {
						who = ROOT
						modifier = swe_betrayed_the_holy_see
					}
				}
			}
			change_religion = protestant
			capital_scope = {
				change_religion = protestant
			}
			random_owned_province = {
				limit = {
					region = scandinavia_region
					religion = catholic
				}
				change_religion = protestant
			}
		}
		else = {
			capital_scope = {
				change_religion = ROOT
			}
			random_owned_province = {
				limit = {
					region = scandinavia_region
					NOT = { religion = ROOT }
				}
				change_religion = ROOT
			}
		}
	}
	if = {
		limit = { has_country_flag = sca_unlock_humanist_missions }
		custom_tooltip = flavor_sca.1.d.tt
		hidden_effect = {
			every_known_country = {
				limit = {
					religion_group = christian
					NOT = { religion = orthodox }
					NOT = { religion = coptic }
				}
				add_opinion = {
					who = ROOT
					modifier = swe_is_not_for_us
				}
			}
		}
	}
	if = {
		limit = { has_country_flag = sca_unlock_norse_missions }
		add_army_tradition = 5
	}
}
select_current_missions_SWE = {
	select_scandinavian_religion_mission_effect = yes
}
select_current_missions_DAN = {
	select_scandinavian_religion_mission_effect = yes
}
select_current_missions_NOR = {
	select_scandinavian_religion_mission_effect = yes
}
select_current_missions_TEU = {
	if = {
		limit = { has_country_flag = teu_crusader_path }
		hidden_effect = {
			clr_country_flag = teu_prussian_path
			clr_country_flag = teu_diplomacy_hre_path
			clr_country_flag = teu_conquest_hre_path
			set_country_flag = formed_prussia_flag
		}
		if = {
			limit = { has_mission = teu_defeat_the_poles }
			hidden_effect = {
				if = {
					limit = {
						has_mission = teu_crusader_mil_reform_1
						NOT = { mission_completed = teu_crusader_mil_reform_1 }
					}
					set_country_flag = teu_crusader_battle_counter
				}
				else = {
					clr_country_flag = teu_crusader_battle_counter
				}
			}
		}
		custom_tooltip = flavor_teu.10.b.ct
		if = {
			limit = { is_part_of_hre = yes }
			set_in_empire = no
		}
		samogitia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		lithuania_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		mazovia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		malopolska_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		central_poland_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
	}
}
select_current_missions_TEU_PRU = {
	if = {
		limit = { has_country_flag = teu_diplomacy_hre_path }
		hidden_effect = {
			clr_country_flag = teu_conquest_hre_path
			clr_country_flag = teu_kingdom_prussia_path
			clr_country_flag = teu_joined_the_hre
		}
		if = {
			limit = { 
				is_part_of_hre = no
				hre_size = 1
			}
			set_in_empire = yes
			emperor = { add_imperial_influence = 10 }
		}			
		mittelmark_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		neumark_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
	}
	if = {
		limit = { has_country_flag = teu_conquest_hre_path }
		if = {
			limit = { 
				is_part_of_hre = no
				hre_size = 1
			}
			set_in_empire = yes
			emperor = { add_imperial_influence = 10 }
		}
		hidden_effect = {
			set_country_flag = teu_conquest_hre_path
			clr_country_flag = teu_diplomacy_hre_path
			clr_country_flag = teu_kingdom_prussia_path
			clr_country_flag = teu_joined_the_hre
		}
		mittelmark_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		neumark_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		vorpommern_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		hinter_pommern_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		mecklenburg_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		add_country_modifier = {
			name = teu_pru_prussian_unification_wars
			duration = 9125
		}
	}
	if = {
		limit = { has_country_flag = teu_kingdom_prussia_path }
		if = {
			limit = { is_part_of_hre = yes }
			set_in_empire = no
		}
		add_prestige = 50
		if = {
			limit = { has_country_flag = teu_is_allowed_to_stay_in_the_hre }
			reverse_add_opinion = {
				who = emperor
				modifier = hre_country_left
			}
		}
		hidden_effect = {
			clr_country_flag = teu_diplomacy_hre_path
			clr_country_flag = teu_conquest_hre_path
			clr_country_flag = teu_joined_the_hre
		}
		samogitia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		lithuania_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		mazovia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		malopolska_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		central_poland_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
	}
}
select_current_missions_LIV = {
	if = {
		limit = {
			has_country_flag = liv_crusader_path
		}
		hidden_effect = {
			set_country_flag = formed_livonia_flag
			set_country_flag = formed_courland_flag
		}
		custom_tooltip = flavor_liv.1.b.ct
		lithuania_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		samogitia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		karelia_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		novgorod_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
		pskov_area = {
			limit = {
				NOT = { is_core = ROOT }
				NOT = { is_permanent_claim = ROOT }
			}
			add_permanent_claim = ROOT
		}
	}
}
select_current_missions_POL = {}	#Empty on purpose, preview system only implemented for the sake of completion
select_current_missions_TUR = {
	if = {
		limit = { has_country_flag = tur_chose_legalism }
		hidden_effect = {
			clr_country_flag = tur_chose_mysticism
			clr_country_flag = tur_non_muslim_path_flag
		}
		add_country_modifier = {
			name = tur_embraced_legalism_modifier
			duration = 18250
		}
	}
	if = {
		limit = { has_country_flag = tur_chose_mysticism }
		hidden_effect = {
			clr_country_flag = tur_chose_legalism
			clr_country_flag = tur_non_muslim_path_flag
		}
		add_country_modifier = {
			name = tur_embraced_mysticism_modifier
			duration = 18250
		}
	}
	if = {
		limit = { has_country_flag = tur_non_muslim_path_flag }
		hidden_effect = {
			clr_country_flag = tur_chose_legalism
			clr_country_flag = tur_chose_mysticism
		}
		add_country_modifier = {
			name = tur_end_of_the_caliphate_modifier
			duration = 18250
		}
	}
}
select_current_missions_MNG = {
	if = {
		limit = { has_country_flag = mng_dynamic_1 }
		clr_country_flag = mng_dynamic_2
		add_country_modifier = { 
			name = haijin_policy_modifier
			duration = -1 
			desc = until_we_complete_the_appropriate_missions_desc
		}
	}
	if = {
		limit = { has_country_flag = mng_dynamic_2 }
		clr_country_flag = mng_dynamic_1
		add_country_modifier = { 
			name = haijin_policy_modifier
			duration = -1 
			desc = until_we_complete_the_appropriate_missions_desc
		}
	}
}
select_current_missions_QNG = {
	if = {
		limit = { has_country_flag = qng_open_ports_flag }
		clr_country_flag = qng_close_ports_flag
		if = {
			limit = { has_reform = mercantilistic_approach_reform }
			add_government_reform = free_trade_reform
		}
		add_country_modifier = {
			name = qng_free_trade_modifier
			duration = 9125 
		}
	}
	if = {
		limit = { has_country_flag = qng_close_ports_flag }
		clr_country_flag = qng_open_ports_flag
		if = {
			limit = { has_reform = free_trade_reform }
			add_government_reform = mercantilistic_approach_reform
		}
		add_country_modifier = {
			name = qng_mercantilism_modifier
			duration = -1 
		}
	}
}

select_current_missions_FRA = {
	if = {
		limit = { has_country_flag = fra_chose_to_piss_off_pope_flag }
		add_country_modifier = { 
			name = fra_italian_wars_modifier
			duration = 7300 
		}
		piedmont_area = { 
			limit = { 
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
			}
			add_permanent_claim = ROOT 
		}
		liguria_area = {
			limit = { 
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
			}
			add_permanent_claim = ROOT 
		}
		lombardy_area = {
			limit = { 
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
			}
			add_permanent_claim = ROOT 
		}
		if = {
			limit = { 
				NAP = { is_subject = no exists = yes } 
			}
			add_casus_belli = {
				target = NAP
				type = cb_vassalize_mission
				months = 180
			}
		}
		else = { 
			naples_area = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_core = ROOT }
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
			calabria_area = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_core = ROOT }
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
			apulia_area = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_core = ROOT }
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
		}
	}
	if = {
		limit = { has_country_flag = fra_papal_lap_dop_flag }
		add_country_modifier = { 
			name = fra_resurgence_of_crusader_fervor_modifier
			duration = 9125
		}
		palestine_area = {
			limit = { 
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
			}
			add_permanent_claim = ROOT 
		}
	}
}
select_current_missions_FRA_HRE = {
	if = {	#Special case when the HRE is already dissolved
		limit = {
			not = { hre_size = 1 }
		}
		add_country_modifier = { 
			name = fra_triumph_over_austria_modifier
			duration = -1 
		}
		add_dip_power = 200 
		clr_country_flag = fra_shed_the_blood_of_the_saxon_man_flag
		set_country_flag = fra_fufujoni_flag
		swap_non_generic_missions = yes
	}
	else = {
		if = {
			limit = { has_country_flag = fra_fufujoni_flag }
			clr_country_flag = fra_shed_the_blood_of_the_saxon_man_flag
			add_country_modifier = { 
				name = fra_war_east_modifier 
				duration = 5475
			}
			if = { 
				limit = { hre_size = 1 }
				custom_tooltip = fra_enable_war_on_the_empire_cb_tt
				hidden_effect = { set_country_flag = fra_enable_war_on_the_empire_cb_flag }
			}
		}
		if = {
			limit = {
				or = { 
					has_country_flag = fra_shed_the_blood_of_the_saxon_man_flag 
					is_emperor = yes 
				}
			}
			clr_country_flag = fra_fufujoni_flag
			add_country_modifier = {
				name = fra_charlemagne_legacy_modifier
				duration = 7300
			}
			every_elector = {
				limit = { 
					has_opinion = { 
						who = ROOT 
						value = 0 
					}
				}
				add_opinion = { 
					who = ROOT 
					modifier = fra_charlemagne_legacy_opinion_modifier
				}
			}
			add_power_projection = {
				type = mission_rewards_power_projection
				amount = 25
			}
			if = {
				limit = { 
					not = { has_country_flag = fra_shed_the_blood_of_the_saxon_man_flag } 
					is_emperor = yes 
				}
				set_country_flag = fra_shed_the_blood_of_the_saxon_man_flag
				custom_tooltip = fra_charlemagne_legacy_tt
				swap_non_generic_missions = yes	#Another special for the moment France becomes Emperor before selecing any of the branching missions
			}
		}
	}
}
select_current_missions_JAP = {
	if = {
		limit = { has_country_flag = jap_mushashi_5_books_flag }
		clr_country_flag = jap_domineering_naval_focus_flag
		add_army_tradition = 10 
		add_country_modifier = {
			name = jap_mushashi_5_books_modifier
			duration = -1 
		}
	}
	if = {
		limit = { has_country_flag = jap_domineering_naval_focus_flag }
		clr_country_flag = jap_mushashi_5_books_flag
		add_navy_tradition = 20 
		add_country_modifier = {
			name = jap_domineering_naval_focus_modifier
			duration = -1 
		}
	}
}
select_current_missions_JAP_RELI = {
	if = {
		limit = { has_country_flag = christianity_defeated_flag }
		clr_country_flag = a_kirishitan_realm
		if = {
			limit = { has_country_flag = significant_christian_presence_flag }
			set_estate_privilege = estate_church_japanese_christian_communities_privilege
		}
		else = {
			add_country_modifier = {
				name = jap_shinto_warriors_modifier
				duration = -1 
			}
		}
	}
	if = {
		limit = { has_country_flag = a_kirishitan_realm }
		clr_country_flag = christianity_defeated_flag
		override_country_name = KRJ
		set_country_flag = is_KRJ_flag
		set_country_flag = has_overriden_name_flag
		add_country_modifier = {
			name = jap_protectors_east_catholicism
			duration = 10950 
		}
	}
}
select_current_missions_BYZ = {}	#Empty, nothing should happen
select_current_missions_PER = {
}

select_current_missions = {
	hidden_effect = {
		clr_country_flag = can_choose_$key$_1_branching_missions
		clr_country_flag = can_choose_$key$_2_branching_missions
		clr_country_flag = can_choose_$key$_3_branching_missions
		change_variable = {
			which = can_preview_missions_var
			value = -1
		}
	}
	select_current_missions_$key$ = yes
}
select_current_branch = {
}

clear_all_branching_flags = {
}

preview_mission_branch_1 = {
}
preview_mission_branch_2 = {
}
preview_mission_branch_4 = {
}
preview_mission_branch_5 = {
	#Origins
	# none
	#Lions of the North
	# none
	#Domination
	# none
	#King of Kings
	# none
	if = {
		limit = { can_preview_mission_of_key_and_batch = { key = DUMMY batch = $batch$ } }
		custom_tooltip = COOL_EFFECT
	}
}
preview_mission_branch = {
	clear_all_branching_flags = { batch = $batch$ }
	preview_mission_branch_$branch$ = { batch = $batch$ }
	hidden_effect = { swap_non_generic_missions = yes }
}